<!doctype html>
<html>
<head lang="en">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>星云彩</title> 
	<meta name="description" content="BlackTie.co - Free Handsome Bootstrap Themes" />	    
	<meta name="keywords" content="themes, bootstrap, free, templates, bootstrap 3, freebie,">
	<meta property="og:title" content="">
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="fancybox/jquery.fancybox-v=2.1.5.css" type="text/css" media="screen">
    <link rel="stylesheet" href="css/font-awesome.min.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="css/style.css">	
	<link href='http://fonts.googleapis.com/css?family=Titillium+Web:400,600,300,200&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
	<link rel="prefetch" href="images/zoom.png">
</head>
<body>
	<div class="navbar navbar-fixed-top" data-activeslide="1">
		<div class="container">
		
			<!-- .navbar-toggle is used as the toggle for collapsed navbar content -->
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>

			
			<div class="nav-collapse collapse navbar-responsive-collapse">
				<ul class="nav row">
					<li data-slide="1" class="col-12 col-sm-2"><a id="menu-link-1" href="#slide-1" title="Next Section"><span class="icon icon-home"></span> <span class="text">主页</span></a></li>
					<li data-slide="2" class="col-12 col-sm-2"><a id="menu-link-2" href="#slide-2" title="Next Section"><span class="icon icon-user"></span> <span class="text">玩法介绍</span></a></li>
					<li data-slide="3" class="col-12 col-sm-2"><a id="menu-link-3" href="#slide-3" title="Next Section"><span class="icon icon-briefcase"></span> <span class="text">开始投注</span></a></li>
					<li data-slide="4" class="col-12 col-sm-2"><a id="menu-link-4" href="#slide-4" title="Next Section"><span class="icon icon-gears"></span> <span class="text">开奖信息</span></a></li>
					<li data-slide="5" class="col-12 col-sm-2"><a id="menu-link-5" href="#slide-5" title="Next Section"><span class="icon icon-heart"></span> <span class="text">投注信息</span></a></li>
					<li data-slide="6" class="col-12 col-sm-2"><a id="menu-link-6" href="#slide-6" title="Next Section"><span class="icon icon-envelope"></span> <span class="text">联系我们</span></a></li>
				</ul>
				<div class="row">
					<div class="col-sm-2 active-menu"></div>
				</div>
			</div><!-- /.nav-collapse -->
		</div><!-- /.container -->
	</div><!-- /.navbar -->
	
	
	<!-- === Arrows === -->
	<div id="arrows">
		<div id="arrow-up" class="disabled"></div>
		<div id="arrow-down"></div>
		<div id="arrow-left" class="disabled visible-lg"></div>
		<div id="arrow-right" class="disabled visible-lg"></div>
	</div><!-- /.arrows -->
	
	
	<!-- === MAIN Background === -->
	<div class="slide story" id="slide-1" data-slide="1">
		<div class="container">
			<div id="home-row-1" class="row clearfix">
				<div class="col-12">
					<h1 class="font-semibold">星云彩</h1>
					<h4 class="font-thin">基于星云链的彩票游戏</h4>
					<br>
					<br>
				</div><!-- /col-12 -->
			</div><!-- /row -->
			<div id="home-row-2" class="row clearfix">
				<div class="col-12 col-sm-4"><div class="home-hover navigation-slide" data-slide="3"><img src="images/s02.png"></div><span>开始投注</span></div>
				<div class="col-12 col-sm-4"><div class="home-hover navigation-slide" data-slide="2"><img src="images/s01.png"></div><span>玩法介绍</span></div>
				<div class="col-12 col-sm-4"><div class="home-hover navigation-slide" data-slide="4"><img src="images/s03.png"></div><span>中奖信息</span></div>
			</div><!-- /row -->
		</div><!-- /container -->
	</div><!-- /slide1 -->
	
	<!-- === Slide 2 === -->
	<div class="slide story" id="slide-2" data-slide="2">
		<div class="container">
			<div class="row title-row">
				<div class="col-12 font-thin">玩法介绍</div>
			</div><!-- /row -->
			<div class="row line-row">
				<div class="hr">&nbsp;</div>
			</div><!-- /row -->
			<div class="row subtitle-row">
				<div class="col-12 font-thin">It's so funny, <span class="font-semibold">have a try now!</span></div>
			</div><!-- /row -->
			<div class="row content-row">
				<div class="col-12 col-lg-3 col-sm-6">
					<p><i class="icon icon-eye-open"></i></p>
					<h2 class="font-thin">公正 <span class="font-semibold">透明</span></h2>
					<h4 class="font-thin">智能合约自动执行开奖和奖金派发，投注信息、中奖信息、奖池奖金全部上链，全程透明可信赖.</h4>
				</div><!-- /col12 -->
				<div class="col-12 col-lg-3 col-sm-6">
					<p><i class="icon icon-laptop"></i></p>
					<h2 class="font-thin">规则 <span class="font-semibold">简单</span></h2>
					<h4 class="font-thin">玩家每次从1-10选择1个数字投注，投注金额金额最少为0.01Nas，满10注自动开奖一次，猜中数字的玩家均分当期累积的奖金奖池.</h4>
				</div><!-- /col12 -->
				<div class="col-12 col-lg-3 col-sm-6">
					<p><i class="icon icon-tablet"></i></p>
					<h2 class="font-thin">操作 <span class="font-semibold">方便</span></h2>
					<h4 class="font-thin">选定数字下注即可等待开奖，开奖后奖金自动转入您下注的账户，操作方便，老少皆宜.</h4>
				</div><!-- /col12 -->
				<div class="col-12 col-lg-3 col-sm-6">
					<p><i class="icon icon-pencil"></i></p>
					<h2 class="font-thin">玩法 <span class="font-semibold">多样</span></h2>
					<h4 class="font-thin">后续发布更多玩法，尽请期待，同时欢迎您的建议.</h4>
				</div><!-- /col12 -->
			</div><!-- /row -->
		</div><!-- /container -->
	</div><!-- /slide2 -->
	
	<!-- === SLide 3 - Portfolio -->
	<div class="slide story" id="slide-3" data-slide="3">
		<div class="container">
			<div class="row title-row">
				<div class="col-12 font-thin" style="padding-top: 20px">开始投注</div>
			</div>
			<!-- /row -->
			<div class="row line-row">
				<div class="hr">&nbsp;</div>
			</div>
			<!-- /row -->
		<!-- <div class="btn-group" id="num-list">
			<div class="row ">
			<button type="button" class="btn btn-primary" value=1>1</button>
			<button type="button" class="btn btn-primary" value=2>2</button>
			<button type="button" class="btn btn-primary" value=3>3</button>
			<button type="button" class="btn btn-primary" value=4>4</button>
			<button type="button" class="btn btn-primary" value=5>5</button>
			<button type="button" class="btn btn-primary" value=6>6</button>
			<button type="button" class="btn btn-primary" value=7>7</button>
			<button type="button" class="btn btn-primary" value=8>8</button>
			<button type="button" class="btn btn-primary" value=9>9</button>
			<button type="button" class="btn btn-primary" value=10>10</button>
		    </div>
		</div> -->
		<div class="row content-row">
				<!-- <div class="col-sm-1 hidden-sm">&nbsp;</div> -->
				<div class="row content-row">
						<!-- <div class="col-sm-1 hidden-sm">&nbsp;</div> -->
						<div class="col-12 col-sm-2">
							<!-- <p><i class="icon icon-bolt"></i></p> -->
							<img src="images/shu.jpg" class="img-rounded">
							<h2 class="font-thin"><span class="font-semibold" >鼠</span></h2>
							<input class="itemSelect" type="radio" name="optionsRadios" id="optionsRadios1" value="1" checked>
							<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> --> 
						</div>
						<div class="col-12 col-sm-2">
							<!-- <p><i class="icon icon-cog"></i></p> -->
							<img src="images/niu.jpg" class="img-rounded">
							<h2 class="font-thin"><span class="font-semibold">牛</span></h2>
							<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="2">
							<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
						</div><!-- /col12 -->
						<div class="col-12 col-sm-2">
							<!-- <p><i class="icon icon-cloud"></i></p> -->
							<img src="images/hu.jpg" class="img-rounded">
							<h2 class="font-thin"><span class="font-semibold">虎</span></h2>
							<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="3">
							<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
						</div><!-- /col12 -->
						<div class="col-12 col-sm-2">
							<!-- <p><i class="icon icon-map-marker"></i></p> -->
							<img src="images/tu.jpg" class="img-rounded">
							<h2 class="font-thin"><span class="font-semibold">兔</span></h2>
							<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="4">
							<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
						</div><!-- /col12 -->
						<div class="col-12 col-sm-2">
							<!-- <p><i class="icon icon-gift"></i></p> -->
							<img src="images/long.jpg" class="img-rounded">
							<h2 class="font-thin"><span class="font-semibold">龙</span></h2>
							<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="5">
							<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
						</div><!-- /col12 -->
						<div class="col-12 col-sm-2">
								<!-- <p><i class="icon icon-gift"></i></p> -->
								<img src="images/she.jpg" class="img-rounded">
								<h2 class="font-thin"><span class="font-semibold">蛇</span></h2>
								<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="6">
								<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
						</div><!-- /col12 -->
			</div>
			<div class="row content-row">
					<!-- <div class="col-sm-1 hidden-sm">&nbsp;</div> -->
					<div class="col-12 col-sm-2">
						<!-- <p><i class="icon icon-bolt"></i></p> -->
						<img src="images/ma.jpg" class="img-rounded">
						<h2 class="font-thin"><span class="font-semibold" >马</span></h2>
						<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="7">
						<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
					</div>
					<div class="col-12 col-sm-2">
						<!-- <p><i class="icon icon-cog"></i></p> -->
						<img src="images/yang.jpg" class="img-rounded">
						<h2 class="font-thin"><span class="font-semibold">羊</span></h2>
						<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="8">
						<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
					</div><!-- /col12 -->
					<div class="col-12 col-sm-2">
						<!-- <p><i class="icon icon-cloud"></i></p> -->
						<img src="images/hou.jpg" class="img-rounded">
						<h2 class="font-thin"><span class="font-semibold">猴</span></h2>
						<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="9">
						<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
					</div><!-- /col12 -->
					<div class="col-12 col-sm-2">
						<!-- <p><i class="icon icon-map-marker"></i></p> -->
						<img src="images/ji.jpg" class="img-rounded">
						<h2 class="font-thin"><span class="font-semibold">鸡</span></h2>
						<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="10">
						<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
					</div><!-- /col12 -->
					<div class="col-12 col-sm-2">
						<!-- <p><i class="icon icon-gift"></i></p> -->
						<img src="images/gou.jpg" class="img-rounded">
						<h2 class="font-thin"><span class="font-semibold">狗</span></h2>
						<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="11">
						<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
					</div><!-- /col12 -->
					<div class="col-12 col-sm-2">
						<!-- <p><i class="icon icon-gift"></i></p> -->
						<img src="images/zhu.jpg" class="img-rounded">
						<h2 class="font-thin">
							<span class="font-semibold">猪</span>
						</h2>
						<input type="radio" class="itemSelect" name="optionsRadios" id="optionsRadios1" value="12">
						<!-- <h4 class="font-thin">It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</h4> -->
					</div>
					<!-- /col12 -->
				</div>
			<button style="margin-top: 20px; margin-bottom: 30px;width:30%" type=" button" class="btn btn-primary btn-lg" id="bit" >投注</button>
	
		</div>
	</div><!-- /slide3 -->
	
	<!-- === Slide 4 - Process === -->
	<div class="slide story" id="slide-4" data-slide="4">
		<div class="container" id="win" v-clock>
			<div class="row title-row">
				<div class="col-12 font-semibold">第 {{term}} 期开奖信息</div>
			</div>
			<!-- /row -->
			<div class="row line-row">
				<div class="hr">&nbsp;</div>
			</div>
			<!-- /row -->
			<div class="row subtitle-row">
				<!-- <div class="col-sm-1 hidden-sm">&nbsp;</div> -->
					<div class="col-12 col-sm-12 font-light" style="padding-top:10px"> 中奖号码</div>
					<div class="col-sm-5 hidden-sm">&nbsp;</div>
					<div class="col-sm-2 col-12"  v-html="getImg(info.num)"></div>
					<div class="col-12 col-sm-12 font-light">中奖金额 
						<span class="font-semibold" style="font-size:40px;color:red" v-html="getContent(info.value)"></span>	NAS
					</div>
					<!-- <div class="col-sm-1 hidden-sm">&nbsp;</div> -->
				
				<!-- /row -->
				<!-- <div class="col-sm-1 hidden-sm">&nbsp;</div> -->
			</div>
			<!-- /container -->
			<div class="row content-row">
				<div>
					<h2>中奖地址</h2>
					 <div v-for="item in getAddrs(info.address)" class="list-group-item list-group-item-success" >
						 <div style="font-size: 20px;color:black">{{item}}</span></div>  
					 </div>
				</div>
			</div>
		</div>
		<!-- /slide4 -->
	</div>
	<!-- === Slide 5 === -->
	<div class="slide story" id="slide-5" data-slide="5">
		<div class="container" id="bet-list" v-clock>
			<div class="row title-row">
				<div class="col-12 font-semibold">第 {{term}} 期投注信息</div>
			</div><!-- /row -->
			<div class="row line-row">
				<div class="hr">&nbsp;</div>
			</div><!-- /row -->
<!-- 			<div class="row subtitle-row">
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
				<div class="col-12 col-sm-10 font-light">Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin literature from 45 BC, making it over 2000 years old. <br/><br/> The standard chunk of Lorem Ipsum used since the 1500s is reproduced below for those interested. Sections 1.10.32 and 1.10.33 from "de Finibus Bonorum et Malorum" by Cicero.</div>
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
			</div>-->

			<div class="row content-row">
				<table class="table table-condensed" >
					<thead>
						<tr style="font-size: 18px; color:orangered">
							<th class="font-semibold" data-field="address">地址</th>
							<th class="font-semibold" data-field="amt">金额</th>
							<th class="font-semibold" data-field="num">号码</th>
							<th class="font-semibold" data-field="date">投注时间</th>
						</tr>
					</thead>
					<tr v-for="item in list" style="font-size: 18px;">
					<th data-field="address" v-html="getContent(item.address)"></th>
					<th data-field="amt" v-html="getContent(item.value)"></th>
					<th data-field="num" v-html="getZh(item.num)"></th>
					<th data-field="date" v-html="getContent(item.date)"></th>
					</tr>
				</table>
			
			</div>
				<!-- <div class="col-1 col-sm-1 hidden-sm">&nbsp;</div>
				<div class="col-12 col-sm-12"><h3>地址：xxxxx 时间：2018-11-11 11:11:11 金额：1nas</h3></div>
				<div class="col-12 col-sm-12"><h3>地址：xxxxx 时间：2018-11-11 11:11:11 金额：1nas</h3></div>
				<div class="col-12 col-sm-12"><h3>地址：xxxxx 时间：2018-11-11 11:11:11 金额：1nas</h3></div>
				<div class="col-12 col-sm-12"><h3>地址：xxxxx 时间：2018-11-11 11:11:11 金额：1nas</h3></div>
				<div class="col-12 col-sm-12"><h3>地址：xxxxx 时间：2018-11-11 11:11:11 金额：1nas</h3></div>
				<div class="col-1 col-sm-1 hidden-sm">&nbsp;</div> -->
			</div><!-- /row -->
		</div><!-- /container -->
	</div><!-- /slide5 -->
	
	<!-- === Slide 6 / Contact === -->
	<div class="slide story" id="slide-6" data-slide="6">
		<div class="container">	
			<div class="row title-row">
				<div class="col-12 font-light">更多玩法 <span class="font-semibold">尽请期待</span></div>
			</div><!-- /row -->
			<div class="row line-row">
				<div class="hr">&nbsp;</div>
			</div><!-- /row -->
			<div class="row subtitle-row">
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
				<div class="col-12 col-sm-10 font-light">如需了解更多 请点击以下图标...</div>
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
			</div><!-- /row -->
			<div id="contact-row-4" class="row">
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-phone"></i></a></p>
					<span class="hover-text font-light ">咋了，想骚扰我?</span></a>
				</div><!-- /col12 -->
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-envelope"></i></a></p>
					<span class="hover-text font-light ">guyancanyun@qq.com</span></a>
				</div><!-- /col12 -->
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-home"></i></a></p>
					<span class="hover-text font-light ">深圳<br>某犄角旮旯</span></a>
				</div><!-- /col12 -->
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-facebook"></i></a></p>
					<span class="hover-text font-light ">抱歉无法翻墙</span></a>
				</div><!-- /col12 -->
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-twitter"></i></a></p>
					<span class="hover-text font-light ">什么鸟玩意</span></a>
				</div><!-- /col12 -->
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
			</div><!-- /row -->
		</div><!-- /container -->
	</div><!-- /Slide 6 -->
	
</body>

	<!-- SCRIPTS -->
	<script src="js/html5shiv.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vue"></script>
	<script src="js/jquery-1.10.2.min.js"></script>
	<script src="js/jquery-migrate-1.2.1.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/jquery.easing.1.3.js"></script>
	<script type="text/javascript" src="fancybox/jquery.fancybox.pack-v=2.1.5.js"></script>
	<script src="js/script.js"></script>
	<script src="js/nebPay.js"></script>
	<script src="js/nebulas.js"></script>
	<script src="js/layer.js"></script>
	
	<!-- fancybox init -->
	<script>
		"use strict";
		// 合约地址
		var dappAddress = "n1r3a9B4Xaek7AxGssDwHBW3S9x8YcNphMb";
		// 直接访问星云链的api
		var nebulas = require("nebulas"),
			Account = nebulas.Account,
			neb = new nebulas.Neb();
		// 设置使用的网络
		neb.setRequest(new nebulas.HttpRequest("https://testnet.nebulas.io"));
		// NebPay SDK 为不同平台的交易提供了统一的支付接口
		// 开发者在Dapp页面中使用NebPay API可以通过浏览器插件钱包、手机app钱包等实现交易支付和合约调用。
		var NebPay = require("nebpay");
		var nebPay = new NebPay();

		// 执行合约返回的交易流水号，用于查询交易信息
		var serialNumber;
		// 定时器
		var intervalQuery;

		var curTerm = 1;

		//投注
		$("#bit").click(function () {
			console.log($("#optionsRadios1").val());
			var value = "0.001";
			var callFunction = "bet" //调用的函数名称
			var callArgs = "[" + $("input[name='optionsRadios']:checked").val() + "]"  //参数格式为参数数组的JSON字符串, 比如'["arg"]','["arg1","arg2]'       
			var options = {
				//callback 是交易查询服务器地址,
				//callback: NebPay.config.mainnetUrl //在主网查询(默认值)
				//callback: NebPay.config.testnetUrl //在测试网查询
			};
			// 执行合约中的save方法
			serialNumber = nebPay.call(dappAddress, value, callFunction, callArgs, options);
			//设置定时查询交易结果
			intervalQuery = setInterval(function () {
				queryResultInfo();
			}, 10000); //建议查询频率10-15s,因为星云链出块时间为15s,并且查询服务器限制每分钟最多查询10次。

		});

		// 根据交易流水号查询执行结果数据
		function queryResultInfo() {
			nebPay.queryPayInfo(serialNumber)
				.then(function (resp) {
					console.log("tx result: " + resp)
					//$("#result").val(resp);
					var respObject = JSON.parse(resp)
					if (respObject.code === 0) {
						layer.msg(`恭喜您的下注已成功，请关注开奖结果!`);
						clearInterval(intervalQuery);
					}
				})
				.catch(function (err) {
					console.log(err);
				})
		} 

		function getLatestTerm() {
			var from = Account.NewAccount().getAddressString();
			var value = "0";
			var nonce = "0";
			var gas_price = "1000000";
			var gas_limit = "2000000";
			var callFunction = "getLatestTerm";
			var callArgs = "[]";
			var contract = {
				"function": callFunction,
				"args": callArgs
			};
			neb.api.call(from, dappAddress, value, nonce, gas_price, gas_limit, contract).then(function (resp) {
				//searchRes(resp)
				console.log("term is：" + resp.result);
				curTerm = resp.result;
				layer.msg("第 "+resp.result+" 期正在投注中...");
			}).catch(function (err) {
				//cbSearch(err)
				console.log("error:" + err.message)
			});
		}

		getLatestTerm();
		getLatestBets();
		getLatestWins();

		// function getBetsByTerm(term) {
		// 	if(!term){
		// 		console.log("term is null");
		// 		return;
		// 	}
		// 	var from = Account.NewAccount().getAddressString();
		// 	var value = "0";
		// 	var nonce = "0"
		// 	var gas_price = "1000000"
		// 	var gas_limit = "2000000"
		// 	var callFunction = "getBets";
		// 	var callArgs = "[" + term +"]";
		// 	var contract = {
		// 		"function": callFunction,
		// 		"args": callArgs
		// 	}
		// 	neb.api.call(from, dappAddress, value, nonce, gas_price, gas_limit, contract).then(function (resp) {
		// 		//searchRes(resp)
		// 		//console.log("bet list is："+resp.result)
		// 		cbSearch(resp);
		// 	}).catch(function (err) {
		// 		//cbSearch(err)
		// 		console.log("error:" + err.message)
		// 	})
		// }

	    function getLatestBets() {
			var from = Account.NewAccount().getAddressString();
			var value = "0";
			var nonce = "0"
			var gas_price = "1000000"
			var gas_limit = "2000000"
			var callFunction = "getLatestBets";
			var callArgs = "[]";
			var contract = {
				"function": callFunction,
				"args": callArgs
			}
			neb.api.call(from, dappAddress, value, nonce, gas_price, gas_limit, contract).then(function (resp) {
				//searchRes(resp)
				//console.log("bet list is："+resp.result)
				cbSearch(resp);
			}).catch(function (err) {
				//cbSearch(err)
				console.log("error:" + err.message)
			})
		}

	    function getLatestWins() {
			var from = Account.NewAccount().getAddressString();
			var value = "0";
			var nonce = "0"
			var gas_price = "1000000"
			var gas_limit = "2000000"
			var callFunction = "getLatestWins";
			var callArgs = "[]";
			var contract = {
				"function": callFunction,
				"args": callArgs
			}
			neb.api.call(from, dappAddress, value, nonce, gas_price, gas_limit, contract).then(function (resp) {
				//searchRes(resp)
				//console.log("bet list is："+resp.result)
				// cbSearch(resp);
				//console.log("get win detail is："+resp.result)
				if(!resp.result){
					return;
				}
				var obj = resp.result;    ////resp is an object, resp.result is a JSON string
			    obj = eval(JSON.parse(obj))	;
			    var term = obj.term;
			    var info = obj.win;
				console.log("return of get wins call: " + JSON.stringify(info))
				if (!info) {
					layer.msg('没有查询到中奖信息！');
				}
				Vue.set(winx, 'info', info);
				Vue.set(winx, 'term', term);
				
			}).catch(function (err) {
				//cbSearch(err)
				console.log("error:" + err.message)
			})
		}

		function cbSearch(resp) {
			var obj = resp.result;    ////resp is an object, resp.result is a JSON string
			obj = eval(JSON.parse(obj))	;
			var term = obj.term;
			var list = obj.list;
			console.log("return of rpc call: " + JSON.stringify(obj))
			if (list == []) {
				layer.msg('没有查询中奖信息');
			} 
				//if result is not null, then it should be "return value" or "error message"
				// try {
				// 	var obj = eval(JSON.parse(list))
				// } catch (err) {
				// 	layer.msg('解析返回内容失败！');
				// }
				// var result = [];
				// result.push(obj);

			Vue.set(app, 'list', list);
			Vue.set(app, 'term', term);
		}

    //投注清单
	var app = new Vue({
		el: '#bet-list',
		data: {
			list: [],
			term: null
		},
		methods: {
			getContent:function(text){
                return text;   
			},
			getZh: function(text){
				var source = transferValToDst(text);
				return source["name"];
			}
		}
	});

    //中奖名单
	var winx = new Vue({
		el: '#win',
		data: {
			info:{},
			term:null 	
		},
		methods: {
			getContent:function(text){

                return text;   
			},
			getAddrs: function(text){
				if(!text){
					return [];
				}
				return text.split(",");
			},
			getImg: function(text){
				if(!text){
					return null;
				}
				var source = transferValToDst(text);
				var url = source["url"];
				url =  '<img src="' + url + '" class="img-rounded">';
				console.log(url);
				return url;
			},
			getZh: function(text){
				if(!text){
					return null;
				}
				var source = transferValToDst(text);
				return source["name"];
			}
		}
	});

		// function getLaestWinsByTerm(term) {
		// 	var from = Account.NewAccount().getAddressString();
		// 	var value = "0";
		// 	var nonce = "0"
		// 	var gas_price = "1000000"
		// 	var gas_limit = "2000000"
		// 	var callFunction = "getWinsByTerm";
		// 	var callArgs = "[" + term +"]";
		// 	var contract = {
		// 		"function": callFunction,
		// 		"args": callArgs
		// 	}
		// 	neb.api.call(from, dappAddress, value, nonce, gas_price, gas_limit, contract).then(function (resp) {
		// 		//searchRes(resp)
		// 		console.log("wins is："+resp)
		// 	}).catch(function (err) {
		// 		//cbSearch(err)
		// 		console.log("error:" + err.message)
		// 	})
		// }

	var valMapping = {
		"1":{ "name": "鼠", "url":"images/shu.jpg"},
		"2":{ "name": "牛", "url":"images/niu.jpg"},
		"3":{ "name": "虎", "url":"images/hu.jpg"},
		"4":{ "name": "兔", "url":"images/tu.jpg"},
		"5":{ "name": "龙", "url":"images/long.jpg"},
		"6":{ "name": "蛇", "url":"images/she.jpg"},
		"7":{ "name": "马", "url":"images/ma.jpg"},
		"8":{ "name": "羊", "url":"images/yang.jpg"},
		"9":{ "name": "猴", "url":"images/hou.jpg"},
		"10":{ "name": "鸡", "url":"images/ji.jpg"},
		"11":{ "name": "狗", "url":"images/gou.jpg"},
		"12":{ "name": "猪", "url":"images/zhu.jpg"}
	}

	function transferValToDst(val)
	{
		var	obj = valMapping[val];
		return obj;
	}




	$(document).ready(function(e) {
		var lis = $('.nav > li');
		menu_focus( lis[0], 1 );
		
		$(".fancybox").fancybox({
			padding: 10,
			helpers: {
				overlay: {
					locked: false
				}
			}
		});
	
	});

	$(".itemSelect").change(  
        function() {  
		var id = $("input[name='optionsRadios']:checked").val(); 
		console.log("radio value change to:"+id);
		var resource = transferValToDst(id);
		layer.msg("您选择了 " + resource["name"]);
        }  
    );  
	</script>

<!-- <script>
	//检测浏览器是否安装星云钱包
	if (typeof (webExtensionWallet) === "undefined") {
		alert('星云钱包环境未运行，请安装钱包插件或开启');
		var dom = document.get.getElementsByClassName('loading')[0]
		dom.style.display = 'block';
	} else {
		console.log('星云钱包环境运行成功');
	}
</script> -->
</html>